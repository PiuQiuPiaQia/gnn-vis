# GraphCast å›¾ç¥ç»ç½‘ç»œæ°”è±¡æ•°æ®å¤„ç†å®éªŒ

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº GraphCast çš„æ°”è±¡æ•°æ®å›¾ç¥ç»ç½‘ç»œå¤„ç†å®éªŒï¼Œç”¨äºå°† ERA5 æ°”è±¡æ•°æ®è½¬æ¢ä¸ºå›¾ç»“æ„å¹¶åº”ç”¨å›¾ç¥ç»ç½‘ç»œæŠ€æœ¯è¿›è¡Œç ”ç©¶ã€‚

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
graphcast-test/
â”œâ”€â”€ getEra5.py                  # ERA5 æ°”è±¡æ•°æ®ä¸‹è½½
â”œâ”€â”€ era52Geometric.py           # æ•°æ®è½¬å›¾ç»“æ„
â”œâ”€â”€ transformDataset.py         # ä½ç½®ç¼–ç å¤„ç†
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºï¼ˆè“å™ªå£°é‡‡æ ·ä¸å¯è§†åŒ–ï¼‰
â”œâ”€â”€ testPE.py                   # ä½ç½®ç¼–ç æµ‹è¯•
â”œâ”€â”€ graphcast-embedding.py      # GraphCast åµŒå…¥åŠ è½½
â”œâ”€â”€ mean_temperature.nc         # ERA5 å¹³å‡æ¸©åº¦æ•°æ®
â”œâ”€â”€ Figure_1.png                # å¯è§†åŒ–è¾“å‡º
â””â”€â”€ GraphCast-BlueNoiseSampling.png  # è“å™ªå£°é‡‡æ ·ç»“æœ
```

## ğŸ”§ åŠŸèƒ½è¯´æ˜

### 1. getEra5.py - ERA5 æ•°æ®ä¸‹è½½
ä» Google Cloud Storage è·å– ERA5 æ°”è±¡æ•°æ®é›†ï¼š
- æ•°æ®æºï¼š[WeatherBench2](https://console.cloud.google.com/storage/browser/weatherbench2/datasets/era5/1959-2022-6h-240x121_equiangular_with_poles_conservative.zarr)
- æå– 2ç±³æ¸©åº¦æ•°æ®ï¼ˆ2m_temperatureï¼‰
- æ—¶é—´èŒƒå›´ï¼š2020-01-01
- è¾“å‡ºï¼š`mean_temperature.nc` å’Œ `mean_temperature.png`

### 2. era52Geometric.py - æ•°æ®è½¬å›¾ç»“æ„
å°† ERA5 ç½‘æ ¼æ•°æ®è½¬æ¢ä¸º PyTorch Geometric å›¾æ•°æ®ç»“æ„ï¼š
- **èŠ‚ç‚¹ç‰¹å¾**ï¼šæ¸©åº¦å€¼
- **èŠ‚ç‚¹åæ ‡**ï¼šç½‘æ ¼ç´¢å¼•
- **è¾¹è¿æ¥**ï¼šç›¸é‚»ç½‘æ ¼ç‚¹ä¹‹é—´çš„è¿æ¥ï¼ˆä¸Šä¸‹å·¦å³ï¼‰

### 3. transformDataset.py - ä½ç½®ç¼–ç 
å¯¹å›¾æ•°æ®æ·»åŠ ä½ç½®ç¼–ç ï¼ˆPositional Encodingï¼‰ï¼š
- **Laplacian Eigenvector PE**ï¼šæ‹‰æ™®æ‹‰æ–¯ç‰¹å¾å‘é‡ä½ç½®ç¼–ç 
- **Random Walk PE**ï¼šéšæœºæ¸¸èµ°ä½ç½®ç¼–ç 
- ç”¨äºæ•è·èŠ‚ç‚¹åœ¨å›¾ä¸­çš„ç»“æ„ä¿¡æ¯

### 4. main.py - è“å™ªå£°é‡‡æ ·ä¸å¯è§†åŒ–
ä¸»ç¨‹åºå…¥å£ï¼š
- ä½¿ç”¨è“å™ªå£°é‡‡æ ·ï¼ˆBlue Noise Samplingï¼‰å¯¹å›¾èŠ‚ç‚¹è¿›è¡Œé™é‡‡æ ·
- é‡‡æ ·ç‡ï¼š30%
- è¾“å‡ºï¼š`GraphCast-BlueNoiseSampling.png`

### 5. testPE.py - ä½ç½®ç¼–ç æµ‹è¯•
åœ¨ Cora æ•°æ®é›†ä¸Šæ¼”ç¤ºä¸åŒä½ç½®ç¼–ç æ–¹æ³•çš„æ•ˆæœ

### 6. graphcast-embedding.py - GraphCast åµŒå…¥
åŠ è½½å¹¶æŸ¥çœ‹ GraphCast æ¨¡å‹çš„ç½‘æ ¼åˆ°ç½‘æ ¼å›¾ç»“æ„

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å®‰è£…ä¾èµ–
```bash
pip install xarray numpy torch torch-geometric networkx matplotlib zarr gcsfs pandas packaging
```

### è¿è¡Œæµç¨‹

1. **ä¸‹è½½ ERA5 æ•°æ®**ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
```bash
python getEra5.py
```

2. **è¿è¡Œä¸»ç¨‹åº**ï¼ˆè“å™ªå£°é‡‡æ ·ä¸å¯è§†åŒ–ï¼‰
```bash
python main.py
```

3. **æµ‹è¯•ä½ç½®ç¼–ç **
```bash
python testPE.py
```

## ğŸ“Š å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ERA5 æ°”è±¡æ•°æ®   â”‚  (getEra5.py)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mean_temperature â”‚  (.nc æ–‡ä»¶)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å›¾ç»“æ„è½¬æ¢     â”‚  (era52Geometric.py)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PyG Data å¯¹è±¡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä½ç½®ç¼–ç       â”‚  (transformDataset.py)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è“å™ªå£°é‡‡æ ·     â”‚  (main.py)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¯è§†åŒ–è¾“å‡º     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“– å‚è€ƒèµ„æ–™

- [GraphCast è®ºæ–‡](https://arxiv.org/abs/2212.12794)
- [PyTorch Geometric æ–‡æ¡£](https://pytorch-geometric.readthedocs.io/)
- [ERA5 æ•°æ®é›†](https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5)
- [WeatherBench2](https://github.com/google-research/weatherbench2)

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ª GraphCast åŸé¡¹ç›®çš„è®¸å¯è¯ã€‚
